C51 COMPILER V8.06   JP                                                                    07/05/2020 15:59:06 PAGE 1   


C51 COMPILER V8.06, COMPILATION OF MODULE JP
OBJECT MODULE PLACED IN jp.OBJ
COMPILER INVOKED BY: C:\Keil\C51\BIN\C51.EXE jp.c BROWSE DEBUG OBJECTEXTEND

line level    source

   1          #include<reg52.h>
   2          #include<intrins.h>
   3          #define uint unsigned int 
   4          #define uchar unsigned char
   5          sbit W_LE=P2^7;
   6          sbit D_LE=P2^6;
   7          uchar num,shi,ge;
   8          unsigned char code Duan[11] =
   9           {0x3f,0x06,0x5b,0x4f,0x66,0x6d,0x7d,0x07,0x7f,0x6f,0X40};//共阴数码管显示段码值 0~9再加0X40
  10          unsigned char code Wei[8] =
  11           {0xfe,0xfd,0xfb,0xf7,0xef,0xdf,0xbf,0x7f}; //数码管的位码,共八位，低电平有效。
  12          
  13          void delay(uint z)
  14          {
  15   1              uint i,y;
  16   1              for(i=z;i>0;i--)
  17   1                      for(y=120;y>0;y--);
  18   1      }
  19          void key()
  20          {       
  21   1              P3=0x0f; //行扫描
  22   1              if(P3!=0x0f)
  23   1              {
  24   2                      delay(10);
  25   2                      if(P3!=0x0f)
  26   2                      {
  27   3                              switch(P3)
  28   3                              {
  29   4                                      case 0x0e: num=1; break;
  30   4                                      case 0x0d: num=5; break;
  31   4                                      case 0x0b: num=9; break;
  32   4                                      case 0x07: num=13;break;
  33   4                      
  34   4                              }
  35   3                              P3=0xf0;        //列扫描
  36   3                              switch(P3)
  37   3                              {
  38   4                                      case 0xe0: num=num;   break;
  39   4                                      case 0xd0: num=num+1; break;
  40   4                                      case 0xb0: num=num+2; break;
  41   4                                      case 0x70: num=num+3; break;
  42   4                              }
  43   3                              while(P3!=0xf0);//松手检测，按键按下时一直满足while循环，当松开按键时，程序才能退出while循环
  44   3                      } 
  45   2              }
  46   1              P3=0xff;
  47   1              if(P3!=0xff){
  48   2              delay(10);
  49   2                      if(P3!=0xff){
  50   3                              switch (P3){
  51   4                              case 0xfe: num=17; break;
  52   4                              case 0xfd: num=18; break;
  53   4                              case 0xfb: num=19; break;
  54   4                              case 0xf7: num=20; break;                       
  55   4                              }
C51 COMPILER V8.06   JP                                                                    07/05/2020 15:59:06 PAGE 2   

  56   3                              while(P3!=0xff);
  57   3                      }
  58   2              }
  59   1      }       
  60          
  61          
  62                  
  63          void display()
  64          {
  65   1              shi=num/10;
  66   1              ge=num%10;
  67   1              P0=0xff;
  68   1              W_LE=1;
  69   1              P0=Wei[0];
  70   1              W_LE=0;
  71   1      
  72   1              D_LE=1;
  73   1              P0=Duan[shi];
  74   1              D_LE=0;
  75   1              delay(5);
  76   1      
  77   1              P0=0xff;
  78   1              W_LE=1;
  79   1              P0=Wei[1];
  80   1              W_LE=0;
  81   1      
  82   1              D_LE=1;
  83   1              P0=Duan[ge];
  84   1              D_LE=0;
  85   1              delay(5);
  86   1      }
  87          void main()
  88          {
  89   1              while(1)
  90   1              {
  91   2                      key();
  92   2                      display();
  93   2              }
  94   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    289    ----
   CONSTANT SIZE    =     19    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =      3    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
